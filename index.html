<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>T1 → Mini-Rack MMC Mapper</title>
  <link rel="stylesheet" href="styles.css">
</head>
  <div class="bgAnim" aria-hidden="true">
    <span class="blob b1"></span>
    <span class="blob b2"></span>
    <span class="blob b3"></span>
  </div>
  <div class="app">
    <div class="card">
      <h1 class="mainHeading">T1-T2 Mapper</h1>
      <div class="stepCard" style="margin-bottom: 18px;">
        <div class="stepBadge">1</div>
        <div>
          <div class="stepTitle">Device Input & Mapping</div>
          <div class="stepText">
            <div style="margin-bottom: 10px;">
              Enter a T1 device (e.g., <code>sbn100-104-es-m1-p5-t1-r89</code>) and JRP with channel (e.g., <code>30-1</code> or just <code>30</code> for channel 1). The tool maps to the Mini‑Rack MMC and spares, shows where it connects in NDF and associated T1 racks, and computes T2 uplink details.
            </div>
            <div style="margin-top: 12px; margin-bottom: 8px;">
              <div style="font-weight: 700; font-size: 13px; color: #047857;">Supported:</div>
            </div>
            <table style="width: 100%; border-collapse: collapse; font-size: 13px;">
              <tr>
                <td style="padding: 8px 12px; border: 2px solid #10b981; background: rgba(16,185,129,0.15); font-weight: 700; color: #047857; width: 40%;">NDF Rack Units</td>
                <td style="padding: 8px 12px; border: 2px solid #10b981; background: rgba(255,255,255,0.9);">RU45, RU44, RU43, RU41, RU39, RU37, RU28, RU26, RU24, RU22, RU20, RU18, RU16</td>
              </tr>
              <tr>
                <td style="padding: 8px 12px; border: 2px solid #10b981; background: rgba(16,185,129,0.15); font-weight: 700; color: #047857;">T1 Racks</td>
                <td style="padding: 8px 12px; border: 2px solid #10b981; background: rgba(255,255,255,0.9);">1–42, 51, 61–96, 99–102, 106–107, 111–112, 114</td>
              </tr>
            </table>
          </div>
        </div>
      </div>

      <div class="grid">
        <div class="field">
          <label for="dev">Device name</label>
          <input id="dev" type="text" placeholder="sbn100-104-es-m1-p5-t1-r89">
          <div class="fErr" id="errDev"></div>
          <div class="muted">Need a quick sample? <button type="button" id="autoExample" class="linkbtn">Example</button></div>
        </div>
        <div class="field">
          <label for="jrp">JRP (17–32)</label>
          <input id="jrp" type="text" placeholder="30-1 (channel defaults to 1 if omitted)">
          <div class="fErr" id="errJrp"></div>
          <div class="muted">Format: JRP-Channel (e.g., 30-1 or just 30 for channel 1)</div>
        </div>
      </div>

      <div class="actions">
        <button id="calc">Find Connection</button>
        <button class="secondary" id="copy">Copy Result</button>
      </div>

      <div id="error" class="err" style="display:none;"></div>

      <div id="out" class="result" style="display:none;">
        <div class="muted" id="more" style="display:none;"></div>
        <div id="miniRackMMCSection" style="margin-top: 16px;">
          <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
            <button id="toggleMiniRackMMC" class="linkbtn" style="font-size: 14px; font-weight: 600; padding: 8px 12px; border-radius: 6px; background: rgba(106,141,255,0.1); border: 1px solid rgba(106,141,255,0.3); display: flex; align-items: center; gap: 8px; cursor: pointer;">
              <span>Mini-Rack MMC Diagram</span>
              <span id="toggleMiniRackIcon" style="font-size: 12px;">▼</span>
            </button>
          </div>
          <div id="miniRackMMCContent" style="display: block;">
            <!-- Step-by-step instructions -->
            <div class="stepCard">
              <div class="stepBadge">2</div>
              <div>
                <div class="stepTitle">Mini-Rack MMC Connections</div>
                <div class="stepText">
                  <div style="margin-bottom: 10px;">
                    On the T1 side, T1 to Mini-Rack is a <strong>2 MPO to 1 MMC cable</strong> that links the switch to the Mini-Rack. Use the <strong>"P" number</strong> to determine which switch you are working with.
                  </div>
                  <div style="margin-bottom: 10px;">
                    So <strong>two JRPs from the switch will combine to one MMC</strong>. The yellow highlighted slot shows your current MMC. <strong>Click on any MMC slot (1–144)</strong> to see which T1 device and JRP it connects to. Use the navigation buttons to view different MMC blocks. Use the mini‑diagram to jump between MMCs.
                  </div>
                </div>
              </div>
            </div>
            <div class="miniInfoStack">
              <div class="infoRow topRow">
                <div class="infoCard deviceCard">
                  <div class="infoLabel">Device</div>
                  <div class="infoValue" id="oDev"></div>
                </div>
                <div class="infoCard jrpCard">
                  <div class="infoLabel">JRP</div>
                  <div class="infoValue" id="oPort"></div>
                  <div class="jrpHint" id="jrpHint"></div>
                </div>
              </div>
              <div class="infoRow bottomRow">
                <div class="infoCard">
                  <div class="infoLabel">Mini-Rack MMC</div>
                  <div class="infoValue highlight" id="oMMC"></div>
                </div>
                <div class="infoCard">
                  <div class="infoLabel">Spare 1</div>
                  <div class="infoValue" id="oSp1"></div>
                </div>
                <div class="infoCard">
                  <div class="infoLabel">Spare 2</div>
                  <div class="infoValue" id="oSp2"></div>
                </div>
              </div>
            </div>
            <div id="mmcViz" class="diagram" aria-hidden="false" style="display:block;">
              <div class="mmcNavBar">
                <div id="blockNavigation" class="blockNavigation">
                  <button class="navStepper" id="blockPrev" title="Previous block">◀ Prev</button>
                  <div class="blockNavBtns">
                    <label for="blockSelect" class="blockNavLabel">Go to MMC:</label>
                    <select id="blockSelect" class="blockSelect">
                      <option value="1">Block 1: MMC 1-18</option>
                      <option value="2">Block 2: MMC 19-36</option>
                      <option value="3">Block 3: MMC 37-54</option>
                      <option value="4">Block 4: MMC 55-72</option>
                      <option value="5">Block 5: MMC 73-90</option>
                      <option value="6">Block 6: MMC 91-108</option>
                      <option value="7">Block 7: MMC 109-126</option>
                      <option value="8">Block 8: MMC 127-144</option>
                    </select>
                  </div>
                  <button class="navStepper" id="blockNext" title="Next block">Next ▶</button>
                </div>
              </div>
              <div id="mmcDiagram" class="slots"></div>
              <div id="currentBlockInfo" style="margin-top: 8px; font-size: 12px; color: #6b7280; text-align: center;"></div>
            </div>
          </div>
        </div>
      </div>

      <div class="footer" id="logicPanel" style="display:none;">
        <div><b>Logic</b>:</div>
        <div>Let <code>P</code> be switch number parsed from <code>-p#-</code>, <code>j</code> be JRP (17..32).</div>
        <div>Pair index: <code>k = floor((P − 1) / 2)</code></div>
        <div>Block start: <code>block_start = 18×k + 1</code></div>
        <div>Offset: <code>0</code> if P odd, <code>8</code> if P even</div>
        <div>Pair index in switch: <code>i = floor((j − 17)/2)</code></div>
        <div>MMC: <code>MMC = block_start + offset + i</code></div>
        <div>Spares: <code>Spare1 = 18×k + 17</code>, <code>Spare2 = 18×k + 18</code></div>
        <div class="muted" id="logicComputed"></div>
      </div>

      <div id="reversePanel" class="card" style="margin-top:16px; display:none;">
        <h1>Mini-Rack MMC → T1 Switch Mapper</h1>
        <p class="sub">Enter an <b>MMC number (1–144)</b> to find the corresponding <b>T1 switch</b> and <b>JRP ports</b>.</p>

        <div class="grid">
          <div class="field">
            <label for="mmcInput">MMC Number</label>
            <input id="mmcInput" type="number" min="1" max="144" placeholder="e.g. 78">
          </div>
        </div>

        <div class="actions">
          <button id="findMMC">Find T1 Mapping</button>
          <button class="secondary" id="resetMMC">Reset</button>
        </div>

        <div id="errorMMC" class="err" style="display:none;"></div>

        <div id="outMMC" class="result" style="display:none;">
          <div class="row">
            <div class="kv"><b>MMC</b><span id="rMMC"></span></div>
            <div class="kv"><b>Switch (P#)</b><span id="rSwitch"></span></div>
            <div class="kv"><b>JRP Ports</b><span id="rPorts"></span></div>
          </div>
          <div class="muted" id="rMore"></div>
        </div>
      </div>
      
      <div id="ndfT2Panel" class="card" style="margin-top:16px;">
        <div class="tabContainer">
          <div class="tabHeader">
            <button class="tabBtn ndf active" id="tabNDF" data-tab="ndf">NDF</button>
            <span class="tabSeparator">|</span>
            <button class="tabBtn t2" id="tabT2" data-tab="t2">T2</button>
          </div>
          <div class="tabContent">
            <div id="ndfTab" class="tabPane active glassMorphism">
        <div class="flowBar"><span>T1</span><span class="sep">➜</span><span>Mini‑Rack</span><span class="sep">➜</span><span>NDF</span><span class="sep">➜</span><span>T2</span></div>
        <div id="outNDF" class="ndfHero" style="display:none;">
          <div class="ndfTitle" id="ndfTitle">NDF</div>
          <div class="row" style="margin-top:6px;">
            <div class="kv ndfEmph"><b>Rack Unit</b><span class="ndfVal" id="ndfRU"></span></div>
            <div class="kv ndfEmph"><b>MMC</b><span class="ndfVal" id="ndfMMC"></span></div>
            <div class="kv"><b>Cable</b><span class="ndfVal" id="ndfCable"></span></div>
            <div class="kv"><b>Active Range</b><span class="ndfVal" id="ndfRange"></span></div>
          </div>
          <div class="actions" style="margin-top:12px;">
            <button class="secondary" id="copyNDF">Copy NDF details</button>
          </div>
          <div class="sub" id="ndfNote"></div>
        </div>
              <div id="ndfChannelSummary" style="margin-top: 15px; border-top: 1px solid #e6e8f0; padding-top: 15px; display: none;">
                <div class="ndfTitle" style="color: #6b7280; font-size: 14px; margin-bottom: 8px;">
                  4-Channel Port Connections (T2 JRP <span id="ndfT2JrpNum"></span>)
                </div>
                <div id="ndfSummaryList" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px;">
        </div>
      </div>
              <div id="flowDiagramContainer" class="flowDiagram" style="display: none; margin-top: 20px;">
                <div class="flowDiagramTitle" style="font-size: 14px; font-weight: 700; color: #6b7280; margin-bottom: 12px;">Data Flow Path</div>
                <svg id="dataFlowDiagram" viewBox="-150 0 1100 760" xmlns="http://www.w3.org/2000/svg">
                  <!-- Tooltip for "Why 4 T1 Racks?" - positioned to the left of T1 Racks -->
                  <g id="t1RacksTooltipGroup">
                    <rect id="t1RacksTooltip" x="-120" y="243" width="110" height="200" rx="6" fill="rgba(15,23,42,0.95)" stroke="rgba(59,130,246,0.3)" stroke-width="1" opacity="0" style="pointer-events: none; transition: opacity 0.2s ease;"/>
                    <foreignObject x="-115" y="248" width="100" height="190" style="pointer-events: none; opacity: 0; transition: opacity 0.2s ease;">
                      <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 6px; font-size: 9px; line-height: 1.3; color: #e5e7eb;">
                        <div style="font-weight: 700; color: #60a5fa; margin-bottom: 5px; font-size: 10px;">Why 4 T1 Racks?</div>
                        <div style="margin-bottom: 6px; font-size: 9px;">These 4 T1 racks share the same <strong style="color: #93c5fd;">Mini-Rack MMC</strong> because they belong to the same <strong style="color: #93c5fd;">4-rack block</strong>.</div>
                        <div style="margin-bottom: 6px; padding-left: 6px; border-left: 2px solid #3b82f6; font-size: 8px;">
                          <div style="margin-bottom: 3px;">• Same switch pair (P)</div>
                          <div style="margin-bottom: 3px;">• Same JRP port</div>
                          <div style="margin-bottom: 3px;">• Sequential racks (R, R+1, R+2, R+3)</div>
                          <div>• Different channels (1-4)</div>
                        </div>
                        <div style="font-size: 8px; color: #9ca3af; margin-top: 6px; padding-top: 6px; border-top: 1px solid rgba(59,130,246,0.2);">
                          Click any rack to see its NDF mapping
                        </div>
                      </div>
                    </foreignObject>
                  </g>
                  
                  <!-- Associated T1 Racks (4 racks sharing same MMC) - Centered vertically -->
                  <g id="associatedT1Racks">
                    <text x="50" y="268" text-anchor="middle" class="flowLabel" font-size="12" font-weight="700" fill="#9ca3af" id="associatedT1RacksTitle">Associated T1 Racks</text>
                    <g class="flowNode" id="t1Rack1">
                      <rect x="10" y="293" width="70" height="40" rx="4" class="flowRack"/>
                      <text x="45" y="308" text-anchor="middle" class="flowLabel" id="t1R1Label" font-size="9" font-weight="600">P-R · JRP</text>
                      <text x="45" y="323" text-anchor="middle" class="flowLabel" id="t1R1Jrp" font-size="8" fill="#9ca3af"></text>
                    </g>
                    <g class="flowNode" id="t1Rack2">
                      <rect x="10" y="338" width="70" height="40" rx="4" class="flowRack"/>
                      <text x="45" y="353" text-anchor="middle" class="flowLabel" id="t1R2Label" font-size="9" font-weight="600">P-R · JRP</text>
                      <text x="45" y="368" text-anchor="middle" class="flowLabel" id="t1R2Jrp" font-size="8" fill="#9ca3af"></text>
                    </g>
                    <g class="flowNode" id="t1Rack3">
                      <rect x="10" y="383" width="70" height="40" rx="4" class="flowRack"/>
                      <text x="45" y="398" text-anchor="middle" class="flowLabel" id="t1R3Label" font-size="9" font-weight="600">P-R · JRP</text>
                      <text x="45" y="413" text-anchor="middle" class="flowLabel" id="t1R3Jrp" font-size="8" fill="#9ca3af"></text>
                    </g>
                    <g class="flowNode" id="t1Rack4">
                      <rect x="10" y="428" width="70" height="40" rx="4" class="flowRack"/>
                      <text x="45" y="443" text-anchor="middle" class="flowLabel" id="t1R4Label" font-size="9" font-weight="600">P-R · JRP</text>
                      <text x="45" y="458" text-anchor="middle" class="flowLabel" id="t1R4Jrp" font-size="8" fill="#9ca3af"></text>
                    </g>
                  </g>
                  
                  <!-- Arrows from T1 racks to their corresponding Mini-Racks -->
                  <g id="t1ToMiniArrows">
                    <path id="t1Arrow1" class="flowPath inactive" d="M 80 313 L 180 313" marker-end="url(#arrowhead)"/>
                    <path id="t1Arrow2" class="flowPath inactive" d="M 80 358 L 180 358" marker-end="url(#arrowhead)"/>
                    <path id="t1Arrow3" class="flowPath inactive" d="M 80 403 L 180 403" marker-end="url(#arrowhead)"/>
                    <path id="t1Arrow4" class="flowPath inactive" d="M 80 448 L 180 448" marker-end="url(#arrowhead)"/>
                  </g>
                  
                  <!-- Arrow marker definitions (multiple colors) -->
                  <defs>
                    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                      <polygon points="0 0, 10 3, 0 6" fill="#3b82f6"/>
                    </marker>
                    <marker id="arrowhead1" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                      <polygon points="0 0, 10 3, 0 6" fill="#3b82f6"/>
                    </marker>
                    <marker id="arrowhead2" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                      <polygon points="0 0, 10 3, 0 6" fill="#ea580c"/>
                    </marker>
                    <marker id="arrowhead3" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                      <polygon points="0 0, 10 3, 0 6" fill="#22c55e"/>
                    </marker>
            <marker id="arrowhead4" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
              <polygon points="0 0, 10 3, 0 6" fill="#78350f"/>
            </marker>
            <marker id="arrowhead5" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
              <polygon points="0 0, 10 3, 0 6" fill="#9ca3af"/>
            </marker>
            <marker id="arrowhead6" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
              <polygon points="0 0, 10 3, 0 6" fill="#ffffff"/>
            </marker>
            <marker id="arrowhead7" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
              <polygon points="0 0, 10 3, 0 6" fill="#dc2626"/>
            </marker>
            <marker id="arrowhead8" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
              <polygon points="0 0, 10 3, 0 6" fill="#000000"/>
            </marker>
          </defs>
                  
                  <!-- Mini-Rack MMC boxes (4 separate boxes, one for each T1 rack) - Centered vertically -->
                  <g id="miniRackNodes">
                    <!-- Single "Mini-Rack" label above all boxes -->
                    <text x="220" y="268" text-anchor="middle" class="flowLabel" font-size="13" font-weight="700" fill="#9ca3af">Mini-Rack</text>
                    
                    <!-- Mini-Rack 1 (aligned with T1 Rack 1) -->
                    <g class="flowNode" id="miniRackNode1">
                      <rect x="180" y="293" width="80" height="40" rx="4" class="flowRack" id="miniRackRect1"/>
                      <text x="220" y="305" text-anchor="middle" class="flowLabel" font-size="9" font-weight="600">MMC</text>
                      <text x="220" y="318" text-anchor="middle" class="flowLabel" id="mmcLabel1" font-size="10" font-weight="700">MMC</text>
                      <circle cx="260" cy="313" r="4" fill="#f59e0b" id="miniRackPort1"/>
                    </g>
                    <!-- Mini-Rack 2 (aligned with T1 Rack 2) -->
                    <g class="flowNode" id="miniRackNode2">
                      <rect x="180" y="338" width="80" height="40" rx="4" class="flowRack" id="miniRackRect2"/>
                      <text x="220" y="350" text-anchor="middle" class="flowLabel" font-size="9" font-weight="600">MMC</text>
                      <text x="220" y="363" text-anchor="middle" class="flowLabel" id="mmcLabel2" font-size="10" font-weight="700">MMC</text>
                      <circle cx="260" cy="358" r="4" fill="#f59e0b" id="miniRackPort2"/>
                    </g>
                    <!-- Mini-Rack 3 (aligned with T1 Rack 3) -->
                    <g class="flowNode" id="miniRackNode3">
                      <rect x="180" y="383" width="80" height="40" rx="4" class="flowRack" id="miniRackRect3"/>
                      <text x="220" y="395" text-anchor="middle" class="flowLabel" font-size="9" font-weight="600">MMC</text>
                      <text x="220" y="408" text-anchor="middle" class="flowLabel" id="mmcLabel3" font-size="10" font-weight="700">MMC</text>
                      <circle cx="260" cy="403" r="4" fill="#f59e0b" id="miniRackPort3"/>
                    </g>
                    <!-- Mini-Rack 4 (aligned with T1 Rack 4) -->
                    <g class="flowNode" id="miniRackNode4">
                      <rect x="180" y="428" width="80" height="40" rx="4" class="flowRack" id="miniRackRect4"/>
                      <text x="220" y="440" text-anchor="middle" class="flowLabel" font-size="9" font-weight="600">MMC</text>
                      <text x="220" y="453" text-anchor="middle" class="flowLabel" id="mmcLabel4" font-size="10" font-weight="700">MMC</text>
                      <circle cx="260" cy="448" r="4" fill="#f59e0b" id="miniRackPort4"/>
                    </g>
                  </g>
                  
                  <!-- Cables from Mini-Racks to NDF (4 separate straight horizontal paths - same format as T1 to Mini-Rack) -->
                  <g id="miniToNdfPaths">
                    <path id="miniToNdfPath1" class="flowPath inactive" d="M 260 313 L 455 313" stroke-dasharray="6 3" marker-end="url(#arrowhead)"/>
                    <path id="miniToNdfPath2" class="flowPath inactive" d="M 260 358 L 455 358" stroke-dasharray="6 3" marker-end="url(#arrowhead)"/>
                    <path id="miniToNdfPath3" class="flowPath inactive" d="M 260 403 L 455 403" stroke-dasharray="6 3" marker-end="url(#arrowhead)"/>
                    <path id="miniToNdfPath4" class="flowPath inactive" d="M 260 448 L 455 448" stroke-dasharray="6 3" marker-end="url(#arrowhead)"/>
                  </g>
                  
                  <!-- NDF with 4 cables (centered between Mini-Rack and T2) - Centered vertically -->
                  <g class="flowNode" id="ndfNode">
                    <rect x="455" y="293" width="100" height="175" rx="4" class="flowRack" id="ndfRect"/>
                    <text x="505" y="268" text-anchor="middle" class="flowLabel" font-size="13" font-weight="700">NDF (4 MMC * 8MPO)</text>
                    <text x="505" y="355" text-anchor="middle" class="flowLabel" font-size="10" font-weight="600">RU · MMC</text>
                    <text x="505" y="373" text-anchor="middle" class="flowLabel" id="ndfLabel" font-size="11" font-weight="700">RU · MMC</text>
                    <text x="505" y="390" text-anchor="middle" class="flowLabel" id="ndfCableLabel" font-size="9" font-weight="600" fill="#9ca3af">cable</text>
                    
                    <!-- 4 input cables from Mini-Rack (aligned with Mini-Rack ports, positioned on left edge) -->
                    <circle cx="455" cy="313" r="4" fill="#10b981"/>
                    <circle cx="455" cy="358" r="4" fill="#10b981"/>
                    <circle cx="455" cy="403" r="4" fill="#10b981"/>
                    <circle cx="455" cy="448" r="4" fill="#10b981"/>
                    
                    <!-- 8 output cables to T2 (positioned on right edge, 4 top and 4 bottom) -->
                    <circle cx="555" cy="320" r="4" fill="#3b82f6"/>
                    <circle cx="555" cy="340" r="4" fill="#3b82f6"/>
                    <circle cx="555" cy="360" r="4" fill="#3b82f6"/>
                    <circle cx="555" cy="380" r="4" fill="#3b82f6"/>
                    <circle cx="555" cy="400" r="4" fill="#3b82f6"/>
                    <circle cx="555" cy="420" r="4" fill="#3b82f6"/>
                    <circle cx="555" cy="440" r="4" fill="#3b82f6"/>
                    <circle cx="555" cy="460" r="4" fill="#3b82f6"/>
                  </g>
                  
                  <!-- Mesh Shuffle (8 dotted paths from NDF to T2) - 4 to top T2 boxes, 4 to bottom T2 boxes -->
                  <g id="ndfToT2Paths">
                    <path id="ndfToT2Path1" class="flowPath active" d="M 555 320 Q 650 80 750 80" marker-end="url(#arrowhead)" stroke-dasharray="6 3" stroke="#9ca3af" opacity="0.8"/>
                    <path id="ndfToT2Path2" class="flowPath active" d="M 555 340 Q 650 170 750 170" marker-end="url(#arrowhead)" stroke-dasharray="6 3" stroke="#9ca3af" opacity="0.8"/>
                    <path id="ndfToT2Path3" class="flowPath active" d="M 555 360 Q 650 260 750 260" marker-end="url(#arrowhead)" stroke-dasharray="6 3" stroke="#9ca3af" opacity="0.8"/>
                    <path id="ndfToT2Path4" class="flowPath active" d="M 555 380 Q 650 350 750 350" marker-end="url(#arrowhead)" stroke-dasharray="6 3" stroke="#9ca3af" opacity="0.8"/>
                    <path id="ndfToT2Path5" class="flowPath active" d="M 555 400 Q 650 440 750 440" marker-end="url(#arrowhead)" stroke-dasharray="6 3" stroke="#9ca3af" opacity="0.8"/>
                    <path id="ndfToT2Path6" class="flowPath active" d="M 555 420 Q 650 530 750 530" marker-end="url(#arrowhead)" stroke-dasharray="6 3" stroke="#9ca3af" opacity="0.8"/>
                    <path id="ndfToT2Path7" class="flowPath active" d="M 555 440 Q 650 620 750 620" marker-end="url(#arrowhead)" stroke-dasharray="6 3" stroke="#9ca3af" opacity="0.8"/>
                    <path id="ndfToT2Path8" class="flowPath active" d="M 555 460 Q 650 710 750 710" marker-end="url(#arrowhead)" stroke-dasharray="6 3" stroke="#9ca3af" opacity="0.8"/>
                  </g>
                  
                  <!-- Associated T2 Channels (8 channels - 4 top, 4 bottom) -->
                  <g id="associatedT2Channels">
                    <text x="810" y="30" text-anchor="middle" class="flowLabel" font-size="12" font-weight="700" fill="#9ca3af">T2 Channels (T1 JRP-Channel Mapping)</text>
                    
                    <!-- Top 4 T2 Channels -->
                    <g class="flowNode" id="t2Channel1">
                      <rect x="750" y="40" width="140" height="80" rx="10" class="flowRack" id="t2Rect1"/>
                      <text x="758" y="65" text-anchor="start" class="flowLabel" id="t2Ch1Label" font-size="12" font-weight="700" fill="white">P#-T2-R#</text>
                      <text x="758" y="85" text-anchor="start" class="flowLabel" id="t2Ch1Jrp" font-size="11" font-weight="600" fill="white">JRP #-#</text>
                      <text x="882" y="68" text-anchor="end" class="flowLabel" id="t2Ch1T1Info" font-size="9" fill="white" font-weight="700" opacity="0.8">T1:--</text>
                    </g>
                    <g class="flowNode" id="t2Channel2">
                      <rect x="750" y="130" width="140" height="80" rx="10" class="flowRack" id="t2Rect2"/>
                      <text x="758" y="155" text-anchor="start" class="flowLabel" id="t2Ch2Label" font-size="12" font-weight="700" fill="white">P#-T2-R#</text>
                      <text x="758" y="175" text-anchor="start" class="flowLabel" id="t2Ch2Jrp" font-size="11" font-weight="600" fill="white">JRP #-#</text>
                      <text x="882" y="158" text-anchor="end" class="flowLabel" id="t2Ch2T1Info" font-size="9" fill="white" font-weight="700" opacity="0.8">T1:--</text>
                    </g>
                    <g class="flowNode" id="t2Channel3">
                      <rect x="750" y="220" width="140" height="80" rx="10" class="flowRack" id="t2Rect3"/>
                      <text x="758" y="245" text-anchor="start" class="flowLabel" id="t2Ch3Label" font-size="12" font-weight="700" fill="white">P#-T2-R#</text>
                      <text x="758" y="265" text-anchor="start" class="flowLabel" id="t2Ch3Jrp" font-size="11" font-weight="600" fill="white">JRP #-#</text>
                      <text x="882" y="248" text-anchor="end" class="flowLabel" id="t2Ch3T1Info" font-size="9" fill="white" font-weight="700" opacity="0.8">T1:--</text>
                    </g>
                    <g class="flowNode" id="t2Channel4">
                      <rect x="750" y="310" width="140" height="80" rx="10" class="flowRack" id="t2Rect4"/>
                      <text x="758" y="335" text-anchor="start" class="flowLabel" id="t2Ch4Label" font-size="12" font-weight="700" fill="white">P#-T2-R#</text>
                      <text x="758" y="355" text-anchor="start" class="flowLabel" id="t2Ch4Jrp" font-size="11" font-weight="600" fill="white">JRP #-#</text>
                      <text x="882" y="338" text-anchor="end" class="flowLabel" id="t2Ch4T1Info" font-size="9" fill="white" font-weight="700" opacity="0.8">T1:--</text>
                    </g>
                    
                    <!-- Bottom 4 T2 Channels -->
                    <g class="flowNode" id="t2Channel5">
                      <rect x="750" y="400" width="140" height="80" rx="10" class="flowRack" id="t2Rect5"/>
                      <text x="758" y="425" text-anchor="start" class="flowLabel" id="t2Ch5Label" font-size="12" font-weight="700" fill="white">P#-T2-R#</text>
                      <text x="758" y="445" text-anchor="start" class="flowLabel" id="t2Ch5Jrp" font-size="11" font-weight="600" fill="white">JRP #-#</text>
                      <text x="882" y="428" text-anchor="end" class="flowLabel" id="t2Ch5T1Info" font-size="9" fill="white" font-weight="700" opacity="0.8">T1:--</text>
                    </g>
                    <g class="flowNode" id="t2Channel6">
                      <rect x="750" y="490" width="140" height="80" rx="10" class="flowRack" id="t2Rect6"/>
                      <text x="758" y="515" text-anchor="start" class="flowLabel" id="t2Ch6Label" font-size="12" font-weight="700" fill="white">P#-T2-R#</text>
                      <text x="758" y="535" text-anchor="start" class="flowLabel" id="t2Ch6Jrp" font-size="11" font-weight="600" fill="white">JRP #-#</text>
                      <text x="882" y="518" text-anchor="end" class="flowLabel" id="t2Ch6T1Info" font-size="9" fill="white" font-weight="700" opacity="0.8">T1:--</text>
                    </g>
                    <g class="flowNode" id="t2Channel7">
                      <rect x="750" y="580" width="140" height="80" rx="10" class="flowRack" id="t2Rect7"/>
                      <text x="758" y="605" text-anchor="start" class="flowLabel" id="t2Ch7Label" font-size="12" font-weight="700" fill="white">P#-T2-R#</text>
                      <text x="758" y="625" text-anchor="start" class="flowLabel" id="t2Ch7Jrp" font-size="11" font-weight="600" fill="white">JRP #-#</text>
                      <text x="882" y="608" text-anchor="end" class="flowLabel" id="t2Ch7T1Info" font-size="9" fill="white" font-weight="700" opacity="0.8">T1:--</text>
                    </g>
                    <g class="flowNode" id="t2Channel8">
                      <rect x="750" y="670" width="140" height="80" rx="10" class="flowRack" id="t2Rect8"/>
                      <text x="758" y="695" text-anchor="start" class="flowLabel" id="t2Ch8Label" font-size="12" font-weight="700" fill="white">P#-T2-R#</text>
                      <text x="758" y="715" text-anchor="start" class="flowLabel" id="t2Ch8Jrp" font-size="11" font-weight="600" fill="white">JRP #-#</text>
                      <text x="882" y="698" text-anchor="end" class="flowLabel" id="t2Ch8T1Info" font-size="9" fill="white" font-weight="700" opacity="0.8">T1:--</text>
                    </g>
                  </g>
                  
                  <!-- Main flow paths (trunk cable section) -->
                </svg>
              </div>
            </div>
            <div id="t2Tab" class="tabPane glassMorphism">
        <div id="outT2" class="t2Hero" style="display:none;">
          <div class="title" id="t2Title">T2 Uplink <span id="t2Tick" class="tick">✓</span></div>
          <div class="row" style="margin-top:6px;">
            <div class="kv t2Emph"><b>Rack Unit</b><span class="value" id="t2RU"></span></div>
            <div class="kv t2Emph"><b>JRP</b><span class="value" id="t2JRP"></span></div>
            <div class="kv t2Emph"><b>Channel</b><span class="value" id="t2CH"></span></div>
            <div class="kv"><b>Plane</b><span class="value" id="t2Plane"></span></div>
          </div>
          <div class="actions" style="margin-top:12px;">
            <button class="secondary" id="copyT2">Copy T2 details</button>
          </div>
          <div class="sub" id="t2Sub"></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div id="historyPanel" class="card" style="margin-top:16px;">
        <h1>Recent Lookups</h1>
        <p class="sub">Last 5 results. Click to re-run.</p>
        <div id="historyList" class="history"></div>
        <div class="actions" style="margin-top:12px;">
          <button class="secondary" id="clearHistory">Clear history</button>
        </div>
      </div>
    </div>
  </div>

  <script src="script.js"></script>
    </body>
    </html>